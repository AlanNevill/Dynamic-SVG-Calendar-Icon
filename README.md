# This SVG always shows today's date

[Originally posted on my blog](https://shkspr.mobi/blog/2018/02/this-svg-always-shows-todays-date/).

For [my contact page](https://edent.tel/), I wanted a generic calendar icon to let people view my diary.  Calendar icons are almost always a skeuomorph of a paper calendar, but I wondered if I could make it slightly more useful by creating a *dynamic* icon.

Here it is, <a href="data:image/svg+xml;base64,PHN2ZyBvbmxvYWQ9ImluaXQoZXZ0KSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgphcmlhLWxhYmVsPSJDYWxlbmRhciIgcm9sZT0iaW1nIgp2aWV3Qm94PSIwIDAgNTEyIDUxMiI+CjxzY3JpcHQgdHlwZT0idGV4dC9lY21hc2NyaXB0Ij48IVtDREFUQVsKZnVuY3Rpb24gaW5pdChldnQpIHsKICB2YXIgdGltZSA9IG5ldyBEYXRlKCk7CiAgdmFyIGxvY2FsZSA9ICJlbi1nYiI7CiAgdmFyIEREICAgPSB0aW1lLmdldERhdGUoKTsKICB2YXIgREREICA9IHRpbWUudG9Mb2NhbGVTdHJpbmcobG9jYWxlLCB7IHdlZWtkYXk6ICJzaG9ydCIgfSk7CiAgdmFyIEREREQgPSB0aW1lLnRvTG9jYWxlU3RyaW5nKGxvY2FsZSwgeyB3ZWVrZGF5OiAibG9uZyIgfSk7CiAgdmFyIE1NICAgPSB0aW1lLmdldE1vbnRoKCkgKyAxOwogIHZhciBNTU0gID0gdGltZS50b0xvY2FsZVN0cmluZyhsb2NhbGUsIHttb250aDogInNob3J0In0pOwogIHZhciBNTU1NID0gdGltZS50b0xvY2FsZVN0cmluZyhsb2NhbGUsIHttb250aDogImxvbmcifSk7CiAgdmFyIFlZWVkgPSB0aW1lLmdldEZ1bGxZZWFyKCk7CiAgCiAgdmFyIHN2Z0RvY3VtZW50ID0gZXZ0LnRhcmdldC5vd25lckRvY3VtZW50OwogIHZhciBkYXlOb2RlID0gc3ZnRG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoREQpOwogIHN2Z0RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJkYXkiKS5hcHBlbmRDaGlsZChkYXlOb2RlKTsKICB2YXIgd2Vla2RheU5vZGUgPSBzdmdEb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShEREREKTsKICBzdmdEb2N1bWVudC5nZXRFbGVtZW50QnlJZCgid2Vla2RheSIpLmFwcGVuZENoaWxkKHdlZWtkYXlOb2RlKTsKICB2YXIgbW9udGhOb2RlID0gc3ZnRG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoTU1NLnRvVXBwZXJDYXNlKCkpOwogIHN2Z0RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJtb250aCIpLmFwcGVuZENoaWxkKG1vbnRoTm9kZSk7CiAgCn0KXV0+PC9zY3JpcHQ+Cgo8cGF0aCBkPSJNNTEyIDQ1NWMwIDMyLTI1IDU3LTU3IDU3SDU3Yy0zMiAwLTU3LTI1LTU3LTU3VjEyOGMwLTMxIDI1LTU3IDU3LTU3aDM5OGMzMiAwIDU3IDI2IDU3IDU3eiIgZmlsbD0iI2UwZTdlYyIvPgo8cGF0aCBkPSJNNDg0IDBoLTQ3YzIgNCA0IDkgNCAxNGEyOCAyOCAwIDEgMS01My0xNEgxMjRjMyA0IDQgOSA0IDE0QTI4IDI4IDAgMSAxIDc1IDBIMjhDMTMgMCAwIDEzIDAgMjh2MTU3aDUxMlYyOGMwLTE1LTEzLTI4LTI4LTI4eiIgZmlsbD0iI2RkMmY0NSIvPgoKPGcgZmlsbD0iI2YzYWFiOSI+CiAgPGNpcmNsZSBjeD0iNDcwIiBjeT0iMTQyIiByPSIxNCIvPgogIDxjaXJjbGUgY3g9IjQ3MCIgY3k9IjEwMCIgcj0iMTQiLz4KICA8Y2lyY2xlIGN4PSI0MjciIGN5PSIxNDIiIHI9IjE0Ii8+CiAgPGNpcmNsZSBjeD0iNDI3IiBjeT0iMTAwIiByPSIxNCIvPgogIDxjaXJjbGUgY3g9IjM4NCIgY3k9IjE0MiIgcj0iMTQiLz4KICA8Y2lyY2xlIGN4PSIzODQiIGN5PSIxMDAiIHI9IjE0Ii8+CjwvZz4KCjx0ZXh0IGlkPSJtb250aCIKICB4PSIzMiIgCiAgeT0iMTY0IiAKICBmaWxsPSIjZmZmIiAKICBmb250LWZhbWlseT0ibW9ub3NwYWNlIgogIGZvbnQtc2l6ZT0iMTQwcHgiCiAgc3R5bGU9InRleHQtYW5jaG9yOiBsZWZ0Ij48L3RleHQ+Cjx0ZXh0IGlkPSJkYXkiCiAgeD0iMjU2IiAKICB5PSI0MDAiIAogIGZpbGw9IiM2Njc1N2YiIAogIGZvbnQtZmFtaWx5PSJtb25vc3BhY2UiCiAgZm9udC1zaXplPSIyNTZweCIKICBzdHlsZT0idGV4dC1hbmNob3I6IG1pZGRsZSI+PC90ZXh0Pgo8dGV4dCBpZD0id2Vla2RheSIKICB4PSIyNTYiIAogIHk9IjQ4MCIgCiAgZmlsbD0iIzY2NzU3ZiIgCiAgZm9udC1mYW1pbHk9Im1vbm9zcGFjZSIKICBmb250LXNpemU9IjY0cHgiCiAgc3R5bGU9InRleHQtYW5jaG9yOiBtaWRkbGUiPjwvdGV4dD4KPC9zdmc+Cg==">an SVG calendar which always display's today's date</a>.



The background image is derived from the [Twitter TweMoji Calendar icon](https://github.com/twitter/twemoji/blob/gh-pages/2/svg/1f4c5.svg) - CC-BY.
  
Text support in SVG is a little awkward, so let me explain how I did this.

SVG supports JavaScript. This will run as soon as the image is loaded.

```
<svg onload="init(evt)" xmlns="http://www.w3.org/2000/svg"
aria-label="Calendar" role="img" viewBox="0 0 512 512">
```

Next step is to get the various date strings. I'm using the `en-GB` locale as that's where I'm based.

```
<script type="text/ecmascript"><![CDATA[
function init(evt) {
  var time = new Date();
  var locale = "en-gb";
```

I want to display something like "Sunday 25 FEB" - the locale options allow for short and long names. So you could have "SUN 25 February".

```
  var DD   = time.getDate();
  var DDDD = time.toLocaleString(locale, {weekday: "long"});
  var MMM = time.toLocaleString(locale,  {month:   "short"});
```

Finally, we need to add the text on to the image.
```  
  var svgDocument = evt.target.ownerDocument;

  var dayNode = svgDocument.createTextNode(DD);
  svgDocument.getElementById("day").appendChild(dayNode);

  var weekdayNode = svgDocument.createTextNode(DDDD);
  svgDocument.getElementById("weekday").appendChild(weekdayNode);

  var monthNode = svgDocument.createTextNode(MMM.toUpperCase());
  svgDocument.getElementById("month").appendChild(monthNode);
  
}
]]></script>
```

Text positioning is relatively simplistic.  An X & Y position which is anchored to the *bottom* of the text - remember that letters with descenders like `g` will extend beyond the bottom of the Y co-ordinate.  This is also where we set the colour of the text, its size, and a font. 

A monospace font makes it easier to predict the layout.
```
<text id="month"
  x="32" 
  y="164" 
  fill="#fff" 
  font-family="monospace"
  font-size="140px"
  style="text-anchor: left"></text>
```

A word on anchoring.  To centre the anchor, use `style="text-anchor: middle"`

A quick test shows that this works on all desktop browsers and Android browsers. I've not tested on iPhones or anything more exotic.

Enjoy!
